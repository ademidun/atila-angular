<div class="container" *ngIf="userProfile">




      <mat-card class="profile-header">

      <mat-card-header class="row">
        <!-- NOTE Mat card header text is hidden in css -->
        <div class="col offset-l2 offset-m4 offset-s2 header-image" mat-card-avatar
             [ngStyle]="{ 'background-image': 'url( '+ userProfile.profile_pic_url +' )' }">

        </div>

      <div >
        <!--Show the profile info, IN the header on regular devices.-->
        <span class="hide-on-med-and-down">
        <div class="col offset-l3-5 offset-m4 " style="margin-left:5%">
          <mat-card-title><h4>{{userProfile.first_name}} {{userProfile.last_name}}</h4></mat-card-title>
          <mat-card-subtitle class="title"><h5>{{userProfile.title}}</h5></mat-card-subtitle>
          <mat-card-subtitle *ngIf="userProfile.post_secondary_school" class="title"><h5>{{userProfile.post_secondary_school}}</h5></mat-card-subtitle>
          <mat-card-subtitle *ngIf="!userProfile.post_secondary_school && userProfile.secondary_school" class="title"><h5>{{userProfile.secondary_school}}</h5></mat-card-subtitle>
          <div class="header-buttons">
            <!--<button mat-raised-button class="btn white-text" (click)="message()">Message</button>-->
            <a *ngIf="profileOwner" (click)="showPreview = !showPreview" style="cursor: pointer">Preview Profile</a> |
            <a *ngIf="profileOwner" [routerLink]="['/edit-profile']">Edit profile</a>
            <!-- <span  *ngIf="profileOwner" >
                <a *ngIf="!showPreview" (click)="showPreview = !showPreview"  href="javascript:undefined">Preview Profile</a>
                <a *ngIf="showPreview" (click)="showPreview = !showPreview"  href="javascript:undefined">Edit Profile</a>
            </span> -->
          </div>
        </div>

        </span>
      </div>
      </mat-card-header>

        <!--Show the profile info, after photo on mobile devices.-->
        <span class="hide-on-large-only">
          <div class="row">
        <div class="col offset-l3-5 offset-m4 " style="margin-left:20%">
          <mat-card-title><h4>{{userProfile.first_name}} {{userProfile.last_name}}</h4></mat-card-title>
          <mat-card-subtitle class="title"><h5>{{userProfile.title}}</h5></mat-card-subtitle>
          <mat-card-subtitle *ngIf="userProfile.post_secondary_school" class="title"><h5>{{userProfile.post_secondary_school}}</h5></mat-card-subtitle>
          <mat-card-subtitle *ngIf="!userProfile.post_secondary_school && userProfile.secondary_school" class="title"><h5>{{userProfile.secondary_school}}</h5></mat-card-subtitle>
          <div class="header-buttons">
            <!--<button mat-raised-button class="btn white-text" (click)="message()">Message</button>-->
            <a *ngIf="profileOwner" (click)="showPreview = !showPreview" style="cursor: pointer">Preview Profile</a> |
            <a *ngIf="profileOwner" [routerLink]="['/edit-profile']">Edit profile</a>
            <!-- <span  *ngIf="profileOwner" >
                <a *ngIf="!showPreview" (click)="showPreview = !showPreview"  href="javascript:undefined">Preview Profile</a>
                <a *ngIf="showPreview" (click)="showPreview = !showPreview"  href="javascript:undefined">Edit Profile</a>
            </span> -->
          </div>
        </div>
      </div>
        </span>

    </mat-card>


      <div *ngIf="profileOwner && !showPreview">

        <nav class="nav-extended">
          <div class="nav-content">
            <ul materialize="tabs" class="tabs tabs-transparent">
              <li class="tab"><a  href="#test1" [ngClass]="myAtilaMode ? '' : 'active'">
                Edit Profile</a></li>
              <li class="tab"><a href="#test2" [ngClass]="myAtilaMode ? 'active' : ''">My Scholarships</a></li>
              <li (click)="getApplications()" class="tab"><a href="#test3">My Applications</a></li>
            </ul>
          </div>
        </nav>

        <div id="test1" class="col s12">
          <form *ngIf="profileOwner" #profileForm="ngForm">
            <h4>Edit <span *ngIf="userProfile.first_name">{{userProfile.first_name}}'s</span> Profile</h4>
            <div class="row">
              <div class="col s6">
                <label>Upload your Profile Picture</label>
                <input class="browser-default" id="profile_pic_url" type="file" placeholder="Upload your Profile Picture"
                       #uploadPicInput name="profile_pic_url">
              </div>

              <mat-progress-bar style="margin-bottom: 1%;" *ngIf="uploadProgress" mode="determinate" [value]="uploadProgress"></mat-progress-bar>

              <div class="col s6">
                <button mat-raised-button class="btn white-text" (click)="uploadProfilePic(uploadPicInput)">Upload</button>
              </div>

            </div>

            <div class="row">
              <mat-form-field class="col s12">
                <label>Profile Headline</label>
                <input class="browser-default" matInput id="title" type="text" placeholder="e.g. Computer Engineering Student"
                       [(ngModel)]="userProfile.title" name="title">
              </mat-form-field>
            </div>
            <div class="row">
              <mat-form-field class="col s12">
                <input class="browser-default" matInput id="post_secondary_school" type="text" placeholder="University/College Name or Apprenticesip Program"
                       [(ngModel)]="userProfile.post_secondary_school" name="post_secondary_school">
              </mat-form-field>
            </div>
            <div class="row">
              <mat-form-field class="col s12">
                <input class="browser-default" matInput id="secondary_school" type="text" placeholder="Secondary School"
                       [(ngModel)]="userProfile.secondary_school" name="secondary_school">
              </mat-form-field>
            </div>
            <button mat-raised-button class="btn white-text" (click)="saveProfile()" style="margin-bottom: 3%">Save</button>
          </form>
        </div>


        <div id="test2" class="col s12">
          <table style="width:100%">
            <tr style="border-bottom-style: inset">
              <th>Name</th>
              <th>Deadline</th>
              <th>My Notes</th>
              <th class="hide-on-small-and-down">Save</th>
            </tr>

            <tr *ngFor="let scholarship of userProfile.metadata['saved_scholarships']">
              <td><a [routerLink]="['/scholarship-detail', scholarship.slug]">{{scholarship.name}}</a></td>
              <td>{{scholarship.deadline | date:'EEEE, MMMM d, y, h:mm a'}}</td>
              <td><textarea style="height: 6.7rem"  [(ngModel)]="scholarship['user_notes']"
                            placeholder="e.g. Upload transcript. Share scholarship with Alice."></textarea></td>
              <td class="hide-on-small-and-down" (click)="saveMyAtila('scholarship',scholarship, i)">
                <i class="material-icons " style="color: #039be5">save</i>
              </td>
              <span class="hide-on-med-and-up">

                  <br>
                  <a (click)="saveMyAtila('scholarship',scholarship, i)" class="col s12">
                    <i class="material-icons ">save</i>
                  </a>

                </span>
            </tr>
          </table>
        </div>
        <div id="test3" class="col s12">
          <table style="width:100%">
            <tr style="border-bottom-style: inset">
              <th>Name</th>
              <th>Deadline</th>
              <th>My Notes</th>
              <th class="hide-on-small-and-down">Save</th>
            </tr>
            <p style="font-size: smaller">Note: Some times may be slightly off due to time zone differences.</p>
              <tr style="border-bottom-style: inset" *ngFor="let application of userApplications; let i = index">
              <td><a [routerLink]="['/applications', application.id]">{{application.scholarship.name}}</a></td>
              <td>{{application.scholarship.deadline | date:'EEEE, MMMM d, y, h:mm a'}}</td>
              <td><textarea style="height: 6.7rem"  [(ngModel)]="application.metadata['user_notes']"
                            placeholder="e.g. Upload transcript. Share scholarship with Alice."></textarea></td>
                <td class="hide-on-small-and-down" (click)="saveMyAtila('application',application, i)">
                  <i class="material-icons " style="color: #039be5">save</i>
                </td>
                <span class="hide-on-med-and-up">

                  <br>
                  <a (click)="saveMyAtila('application',application, i)" class="col s12">
                    <i class="material-icons ">save</i>
                  </a>

                </span>
              </tr>




          </table>
        </div>

      </div>



    <!--<mat-card class="background-card">-->
      <!--<h3></h3>-->
      <!--<mat-card-content>-->
        <!--<p>-->
          <!--{{userProfile.profile_description}}-->
        <!--</p>-->
      <!--</mat-card-content>-->
    <!--</mat-card>-->

  </div>

