<div class="container row">
  <ng-container *ngIf="essay">

    <div class="col-sm-12 center">
      <h1 class="atila-font"> {{essay.title}} </h1>
    </div>

  <div class="col-sm-12 col-md-10  offset-md-1 content-container">
      <a *ngIf="userProfile && (userProfile.user==essay.user.id || userProfile.is_atila_admin)" [routerLink]="[ '/essay/edit', essay.id ]">Edit Essay</a>
      <div *ngIf="!essay.published" style="font-weight: bold; "> | Unpublished</div>
      <!--<img src="{{essay.header_image_url}}" style="max-height: 100%;max-width: 100%" class="center-block"/>-->

      <div class="card">
        <p *ngIf="essay.status" class="card-subtitle text-muted bold m-3" style="font-size: small;">
          Status: {{toTitleCase(essay.status)}}
        </p>
        <div *ngIf="essay.user" class="m-3">
          <a routerLink="/profile/{{essay.user.username}}">
            <div class="chip">
              <img style="max-width: 50px" [src]="essay.user.profile_pic_url"
                   alt="Blog Author">
              <a routerLink="/profile/{{essay.user.username}}">
                {{essay.user.first_name}} {{essay.user.last_name}}
              </a>
            </div>
          </a>
            <p class="text-muted" style="margin-bottom: .1%" *ngIf="essay.user.title">
              {{essay.user.title}}
            </p>
            <p class="text-muted" style="margin-bottom: .1%" *ngIf="essay.user.post_secondary_school || essay.user.secondary_school">
              {{essay.user.post_secondary_school || essay.user.secondary_school}}
            </p>
        </div>
        <a class="card-action" *ngIf="essay.essay_source_url" [href]="essay.essay_source_url" target="_blank">View Original Essay</a>
      </div>

      <hr>

      <h4 class="atila-font" style="font-size: 2.28rem; font-weight: 400">About This Essay</h4>
      <blockquote class="atila-font" style="font-style: italic">
        {{essay.description}}
      </blockquote>
      <!--<div [froalaView]="essay.body" ></div>-->
      <div class="inner-html atila-font" [innerHTML]="essay.body | safeHtml"></div>

    </div>

  <!-- Sidebar Widgets Column -->
  <div class="col-md-4 hide-on-small-and-down">


    <!-- Search Widget
    <div class="card my-4">
      <h5 class="card-header">Search</h5>
      <div class="card-body">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search for...">
          <span class="input-group-btn">
            <button class="btn btn-secondary" type="button">Go!</button>
          </span>
        </div>
      </div>
    </div>

    &lt;!&ndash; Categories Widget &ndash;&gt;
    <div class="card my-4">
      <h5 class="card-header">Categories</h5>
      <div class="card-body">
        <div class="row">
          <div class="col-lg-6">
            <ul class="list-unstyled mb-0">
              <li>
                <a href="#">Web Design</a>
              </li>
              <li>
                <a href="#">HTML</a>
              </li>
              <li>
                <a href="#">Freebies</a>
              </li>
            </ul>
          </div>
          <div class="col-lg-6">
            <ul class="list-unstyled mb-0">
              <li>
                <a href="#">JavaScript</a>
              </li>
              <li>
                <a href="#">CSS</a>
              </li>
              <li>
                <a href="#">Tutorials</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>-->

    <!-- Side Widget -->
    <div class="card my-4">
      <h5 class="card-header">Related<sup style="font-size: small;top: -1em;">Beta</sup></h5>
      <div class="card-body">
        <div  *ngFor="let item of relatedItems; let i = index; first as isFirst;">
          <div (click)="logRelatedItemClick(item)">
            <app-card-generic [item]="item" [metadata]="{hideDescription: item.image}" [cardStyle]="{'max-height': '450px', 'overflow-y': 'hidden'}"> </app-card-generic>
            <!--<app-card-generic class="hide-on-small-and-down" [item]="item" [metadata]="{hideDescription: item.image}" [cardStyle]="{'height': '400px', 'overflow-y': 'hidden'}"> </app-card-generic>-->
            <!--<app-card-generic class="hide-on-med-and-up" [item]="item" [metadata]="{hideDescription: item.image}" [cardStyle]="{'max-height': '300px', 'overflow-y': 'hidden'}"> </app-card-generic>-->
          </div>
        </div>

        <!-- Loading progress circle -->
        <div *ngIf="isLoadingRelatedItems">
          <h5>Loading Related items...</h5>
          <mat-spinner></mat-spinner>
        </div>

      </div>
    </div>

  </div>
  <!--END Sidebar Widgets Column-->

  </ng-container>

  <!-- Loading progress bar -->
  <div *ngIf="!essay" class="col-sm-12 ng-star-inserted"
       style="margin-top: 5%;margin-bottom: 5%;">
    <h3 class="center">
      Loading Essay...
    </h3>
    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
  </div>

</div>
