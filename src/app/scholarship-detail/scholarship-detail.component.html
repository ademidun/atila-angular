<div class="container" *ngIf="scholarship">
  <div class="row">
    <div class="col s6">
      <img class="scholarship-image" [src]="scholarship.img_url" />
    </div>
    <div class="col s6">
      <h3>{{scholarship.name}}</h3>
      <div class="sub-header">

          <div class="date-created">
            <div *ngIf="scholarshipOwner">
              Created by: <a routerLink="/profile/{{scholarshipOwner.username}}">{{scholarshipOwner.first_name}} {{scholarshipOwner.last_name}}</a>
            </div>          
            Deadline: {{scholarship.deadline | date:'longDate'}}<br> 
            <strong>
            <p *ngIf="scholarship.funding_amount > 0">{{scholarship.funding_amount | currency:'USD':true:'1.0-0'}}</p>
            </strong>
            <a *ngIf="scholarship.owner==userId" [routerLink]="['/edit-scholarship', scholarship.slug]"> Edit Scholarship </a><br>
            <a *ngIf="scholarship.owner!=userId" [routerLink]="['/edit-scholarship', scholarship.slug]"> Suggest/View Edits </a><br>
            <a target="_blank" *ngIf="scholarship.form_url" href="{{scholarship.form_url}}"> View Application Form </a><br>
            <a target="_blank" *ngIf="scholarship.scholarship_url" href="{{scholarship.scholarship_url}}"> Visit Scholarship Website </a> <br>
          </div>


        <button md-raised-button *ngIf=scholarship.is_automated (click)="getOrCreateApp()" 
        style="background-color: #1ea0e7; " class="white-text">Apply now</button>
      </div>
      <br>
      <div class="divider"></div>
      <p>{{scholarship.description}}</p>
    </div>
  </div>
  <div class="row">
    <div class="col s12">
      <h4>Criteria</h4>
      <ul>
        <li>
          {{scholarship.criteria_info}}
        </li>
      </ul>
      <ul>
        <!-- TODO: THis should actually be done using a pipe https://stackoverflow.com/questions/35534959/access-key-and-value-of-object-using-ngfor -->
        
        <li *ngIf="scholarship.city">Located in: 
            {{keyGetter(scholarship.city)}}
         </li>
        <li>Field: {{scholarship.education_field}}</li>
      </ul>
    </div>
  </div>
  <div class="row">
      <h4>Comments</h4>

      <div class="col s12">
          <md-form-field>
              <textarea style="min-height: 1em" rows="1" placeholder="Comment Title..." mdInput [(ngModel)]="userComment.title">
              </textarea>
            </md-form-field>
        <md-form-field>
          <textarea style="min-height: 1em" rows="1" placeholder="Leave a comment..." mdInput [(ngModel)]="userComment.text">
          </textarea>
        </md-form-field>
        <button md-raised-button style="background-color: #184E87;" class="btn white-text" (click)="postComment()" >Comment</button>
        <!-- TODO: Use a directive or a pipe to format the comments -->
      </div>

      <div *ngFor="let comment of scholarshipComments; let i = index" class="col s6 comment-box"> 
        <h5>{{comment.title}}</h5><small>{{comment.date_created | date:'medium'}}</small> <span *ngIf="comment.user"> <a routerLink="/profile/{{comment.user.username}}"> {{comment.user.first_name}} {{comment.user.last_name}} </a> </span>
         <p>
         {{comment.text}}
         <p>
         <div  class="col s12"> 

          <button md-mini-fab style="background-color: transparent" [disabled]="comment.user_already_upvoted" (click)="commentVote(i,'upVote')">
            <md-icon class="md-24" aria-label="Like the comment">thumb_up</md-icon>
          </button>{{comment.up_votes_count}}

          <button md-mini-fab style="background-color: transparent" [disabled]="comment.user_already_downvoted" (click)="commentVote(i,'downVote')">
            <md-icon class="md-24" aria-label="Dislike the comment">thumb_down</md-icon>
          </button>{{comment.down_votes_count}}

         </div>
      </div>

  </div>
</div>